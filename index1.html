<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>NAZİLLİ | Dolap Fiyatlandırma</title>
    
    <!-- Kütüphaneler (Cloudflare CDN - En Güvenilir) -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" crossorigin="anonymous">
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;700;900&display=swap');
        body { font-family: 'Inter', sans-serif; -webkit-font-smoothing: antialiased; background-color: #F5F5F5; }
        * { -webkit-tap-highlight-color: transparent; }
        
        @media print { 
            body * { visibility: hidden; }
            .print-hidden { display: none !important; }
            #pdf-content, #pdf-content * { visibility: visible; }
            #pdf-content { position: absolute; left: 0; top: 0; width: 100%; margin: 0; padding: 0; background: white; }
        }

        /* Yükleme Ekranı */
        #loader { position: fixed; inset: 0; background: white; z-index: 99999; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        .spinner { width: 50px; height: 50px; border: 5px solid #f3f3f3; border-top: 5px solid #000; border-radius: 50%; animation: spin 1s linear infinite; margin-bottom: 20px; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body>

    <div id="loader">
        <div class="spinner"></div>
        <p style="font-size: 14px; font-weight: 900; color: #333; letter-spacing: 2px;">YÜKLENİYOR...</p>
    </div>

    <div id="root"></div>

    <script type="text/javascript">
        // --- 1. VERİLER (DATA) ---
        const APP_DATA = {
            INITIAL_SETTINGS: {
                materialPrices: { 'Suntalam': 600, 'MDFlam': 1000, 'Lake': 2500, 'Membran': 2550, 'Akrilik': 5700 },
                glassDoorPrice: 2500,
                hardwarePrices: {
                    hinges: { 'Samet': 400, 'Blum': 1000, 'Hettich': 1000 },
                    slides: { 'Samet': 840, 'Blum': 3960, 'Hettich': 1260 },
                    slidingSystem: 4500,
                    liftSystemBrands: { 'Samet': 1350, 'Blum': 3600, 'Hettich': 2850 },
                    handlePrice: 50 
                },
                laborFactor: 2.5, 
                profitMargin: 2.5
            },
            PRODUCTS: [
                { id: 100, parentCat: 'Alt Dolaplar', subCat: 'Kapaklı', name: 'Kapaklı Alt Dolap', type: 'hinged_base', image: 'https://www.minarmobilya.com/idea/dq/03/myassets/products/365/8684990261720-1.jpg?revision=1767087317', defaultWidth: 60, defaultHeight: 72, defaultDepth: 56 },
                { id: 105, parentCat: 'Alt Dolaplar', subCat: 'Köşe', name: 'Köşe Alt Dolap (L)', type: 'corner_base', image: 'https://img1.wsimg.com/isteam/ip/3c139178-dc7e-4b9d-93ab-c65c7aee5924/ols/900X900mm%20Highline%20Corner%20Base%20Unit%20With%20Shelf.jpg/:/rs=w:1200,h:1200', defaultWidth: 90, defaultHeight: 72, defaultDepth: 56 },
                { id: 106, parentCat: 'Alt Dolaplar', subCat: 'Kör Köşe', name: 'Kör Alt Dolap', type: 'blind_corner_base', image: 'https://www.minarmobilya.com/idea/dq/03/myassets/products/429/8684990262369-1.jpg?revision=1765363294', defaultWidth: 100, defaultHeight: 72, defaultDepth: 56 },
                { id: 2, parentCat: 'Alt Dolaplar', subCat: 'Çekmeceli', name: 'Çekmeceli Alt Dolap', type: 'drawer', image: 'https://www.minarmobilya.com/idea/dq/03/myassets/products/381/8684990261881-1.jpg?revision=1765289033', defaultWidth: 60, defaultHeight: 72, defaultDepth: 56, drawerCount: 3 },
                { id: 201, parentCat: 'Üst Dolaplar', subCat: 'Kapaklı', name: 'Kapaklı Üst Modül', type: 'hinged_upper', image: 'https://www.minarmobilya.com/idea/dq/03/myassets/products/447/8684990262543-1.jpg?revision=1765368218', defaultWidth: 60, defaultHeight: 60, defaultDepth: 32 },
                { id: 202, parentCat: 'Üst Dolaplar', subCat: 'Devirme', name: 'Devirme Kapak Üst Modül', type: 'lift_upper', image: 'https://www.minarmobilya.com/idea/dq/03/myassets/products/411/8684990262185-1.jpg?revision=1765369537', defaultWidth: 80, defaultHeight: 40, defaultDepth: 32 },
                { id: 203, parentCat: 'Üst Dolaplar', subCat: 'Kör Köşe', name: 'Kör Üst Modül', type: 'blind_upper', image: 'https://classycabinet.com/wp-content/uploads/2023/08/b9-copy-1-600x600.jpg', defaultWidth: 90, defaultHeight: 60, defaultDepth: 32 },
                { id: 204, parentCat: 'Üst Dolaplar', subCat: 'Köşe', name: 'Köşe Üst Modül (L)', type: 'corner_upper', image: 'https://www.minarmobilya.com/idea/dq/03/myassets/products/420/8684990262277-1.jpg?revision=1765544537', defaultWidth: 60, defaultHeight: 60, defaultDepth: 32 },
                { id: 300, parentCat: 'Duvar Dolapları', subCat: 'Özel Üretim', name: 'Duvar Ünitesi Dolabı', type: 'wall_cabinet', image: 'https://www.minarmobilya.com/idea/dq/03/myassets/products/671/8681285969040-3.jpg?revision=1759935875', defaultWidth: 200, defaultHeight: 220, defaultDepth: 60 }
            ]
        };

        // --- 2. HESAPLAMA MANTIĞI ---
        const calculateItemPrice = (item, currentSettings) => {
            const { config, product } = item;
            const w1 = parseFloat(config.width) || 0;
            const w2 = parseFloat(config.width2) || 0;
            const w3 = parseFloat(config.width3) || 0;
            const h = parseFloat(config.height) || 0;
            const d = parseFloat(config.depth) || 0;
            
            const drawerCount = parseInt(config.drawerCount) || 0;
            const shelfCount = parseInt(config.shelfCount) || 0;
            const solidDoorCount = parseInt(config.solidDoorCount) || 0;
            const glassDoorCount = parseInt(config.glassDoorCount) || 0;
            const standardDoorCount = parseInt(config.doorCount) || 1;

            let bodyArea = 0;
            let finalDoorCost = 0; 
            let hardwareCost = 0;

            if (product.type === 'wall_cabinet') {
                let totalWidth = w1;
                if (config.cabinetShape === 'L') totalWidth = w1 + w2;
                if (config.cabinetShape === 'U') totalWidth = w1 + w2 + w3;
                bodyArea = ((totalWidth + d) * (h + d)) / 10000;
                const totalDoorArea = (totalWidth * h) / 10000; 

                if (config.doorType === 'sliding') {
                    hardwareCost += (currentSettings.hardwarePrices.slidingSystem || 1500);
                    finalDoorCost = totalDoorArea * currentSettings.materialPrices[config.doorMaterial];
                } else {
                    const totalDoors = solidDoorCount + glassDoorCount;
                    hardwareCost += totalDoors * 4 * (currentSettings.hardwarePrices.hinges[config.hardwareBrand] || 0);
                    if (totalDoors > 0) {
                        const areaPerDoor = totalDoorArea / totalDoors;
                        finalDoorCost = (solidDoorCount * areaPerDoor * currentSettings.materialPrices[config.doorMaterial]) + 
                                        (glassDoorCount * areaPerDoor * currentSettings.glassDoorPrice);
                    }
                }
                if (drawerCount > 0) hardwareCost += drawerCount * (currentSettings.hardwarePrices.slides[config.hardwareBrand] || 0);
            } 
            else {
                let doorArea = 0;
                if (['corner_base', 'corner_upper'].includes(product.type)) {
                    let totalWidth = w1 + w2;
                    bodyArea = (((totalWidth * d * 2) + (totalWidth * h)) / 10000) * 1.25; 
                    doorArea = (totalWidth * h) / 10000;
                    hardwareCost = standardDoorCount * 2 * (currentSettings.hardwarePrices.hinges[config.hardwareBrand] || 0);
                } else if (['blind_corner_base', 'blind_upper'].includes(product.type)) {
                    bodyArea = (((h * d * 2) + (w1 * d * 2) + (w1 * h)) / 10000) * 1.15;
                    if (shelfCount > 0) bodyArea += (shelfCount * (w1 * d)) / 10000;
                    doorArea = ((w1 / 2) * h) / 10000;
                    hardwareCost = standardDoorCount * 2 * (currentSettings.hardwarePrices.hinges[config.hardwareBrand] || 0);
                } else {
                    bodyArea = ((h * d * 2) + (w1 * d * 2) + (w1 * h)) / 10000;
                    if (shelfCount > 0) bodyArea += (shelfCount * (w1 * d)) / 10000;
                    doorArea = (w1 * h) / 10000;
                    if (product.type === 'lift_upper') {
                        hardwareCost = currentSettings.hardwarePrices.liftSystemBrands[config.hardwareBrand] || 0;
                    } else if (product.type === 'drawer') {
                        hardwareCost = drawerCount * (currentSettings.hardwarePrices.slides[config.hardwareBrand] || 0);
                    } else {
                        hardwareCost = standardDoorCount * 2 * (currentSettings.hardwarePrices.hinges[config.hardwareBrand] || 0);
                    }
                }
                const pricePerM2 = config.doorStyle === 'glass' ? currentSettings.glassDoorPrice : currentSettings.materialPrices[config.doorMaterial];
                finalDoorCost = doorArea * (pricePerM2 || 0);
            }

            const total = ((bodyArea * currentSettings.materialPrices[config.bodyMaterial]) + finalDoorCost + hardwareCost) * currentSettings.laborFactor * currentSettings.profitMargin;
            return Math.round(total) || 0;
        };

        // --- 3. REACT UYGULAMASI (Pure JS) ---
        const h = React.createElement;
        const Fragment = React.Fragment;
        const { useState, useEffect, useMemo } = React;

        const App = () => {
            const [view, setView] = useState('home');
            const [selectedProduct, setSelectedProduct] = useState(null);
            const [cart, setCart] = useState([]);
            const [settings, setSettings] = useState(APP_DATA.INITIAL_SETTINGS);
            const [isMenuOpen, setIsMenuOpen] = useState(false);
            const [activeFilter, setActiveFilter] = useState({ parent: null });
            const [customer, setCustomer] = useState({ name: '', phone: '', address: '' });
            const [showTeklifPreview, setShowTeklifPreview] = useState(false);
            const [bulkConfig, setBulkConfig] = useState({ bodyMaterial: 'Suntalam', doorMaterial: 'MDFlam', hardwareBrand: 'Samet' });

            useEffect(() => {
                const loader = document.getElementById('loader');
                if (loader) setTimeout(() => { loader.style.opacity = '0'; setTimeout(() => loader.style.display = 'none', 500); }, 300);
            }, []);

            useEffect(() => {
                const saved = localStorage.getItem('carpenter_v38_cart');
                if (saved) setCart(JSON.parse(saved));
                const savedSettings = localStorage.getItem('carpenter_v38_settings');
                if (savedSettings) setSettings(JSON.parse(savedSettings));
            }, []);

            useEffect(() => {
                localStorage.setItem('carpenter_v38_cart', JSON.stringify(cart));
                localStorage.setItem('carpenter_v38_settings', JSON.stringify(settings));
            }, [cart, settings]);

            const cartTotal = useMemo(() => cart.reduce((sum, item) => sum + (calculateItemPrice(item, settings) * (item.qty || 1)), 0), [cart, settings]);

            const addToCart = (product) => {
                const isSpecial = ['hinged_base', 'corner_base', 'blind_corner_base', 'hinged_upper', 'lift_upper', 'blind_upper', 'corner_upper'].includes(product.type);
                const newItem = {
                    id: Date.now(),
                    product, 
                    qty: 1,
                    config: {
                        width: product.defaultWidth, width2: 150, width3: 150,
                        height: product.defaultHeight, depth: product.defaultDepth,
                        bodyMaterial: bulkConfig.bodyMaterial, doorMaterial: bulkConfig.doorMaterial,
                        hardwareBrand: bulkConfig.hardwareBrand, 
                        cabinetShape: 'Düz',
                        doorType: product.type === 'lift_upper' ? 'lift' : (product.name.includes('Sürme') ? 'sliding' : 'hinged'), 
                        slidingDoorCount: 2, solidDoorCount: 4, glassDoorCount: 0,
                        doorStyle: 'normal',
                        drawerCount: product.type === 'drawer' ? 3 : 0, 
                        shelfCount: isSpecial ? 2 : 0, 
                        doorCount: product.type === 'lift_upper' ? 1 : (['hinged_base', 'corner_base', 'corner_upper'].includes(product.type) ? 2 : 1)
                    }
                };
                setCart([...cart, newItem]);
                setView('cart');
            };

            const updateItemQty = (id, change) => {
                setCart(cart.map(item => item.id === id ? { ...item, qty: Math.max(1, (item.qty || 1) + change) } : item));
            };

            const duplicateItem = (originalItem) => {
                setCart([...cart, { ...originalItem, id: Date.now(), qty: 1 }]);
            };

            const updateItemConfig = (id, field, value) => {
                setCart(cart.map(item => item.id === id ? { ...item, config: { ...item.config, [field]: value } } : item));
            };

            const applyBulkToAll = () => {
                setCart(cart.map(item => ({ ...item, config: { ...item.config, bodyMaterial: bulkConfig.bodyMaterial, doorMaterial: bulkConfig.doorMaterial, hardwareBrand: bulkConfig.hardwareBrand } })));
            };

            // --- YARDIMCI FONKSİYONLAR ---
            const renderInput = (label, value, field, id, type='text', placeholder='') => 
                h('div', null, h('label', { className: 'text-xs font-bold text-slate-400 mb-1.5 block ml-1' }, label), 
                h('input', { type, value, onChange: e => updateItemConfig(id, field, e.target.value), className: 'w-full bg-white border border-slate-200 h-14 px-4 rounded-xl text-center font-black text-lg outline-none focus:border-black', placeholder }));

            const renderSelect = (label, value, field, id, options) =>
                h('div', null, h('label', { className: 'text-xs font-bold text-slate-400 mb-1.5 block ml-1' }, label),
                h('select', { value, onChange: e => updateItemConfig(id, field, e.target.value), className: 'w-full bg-slate-50 border border-slate-200 h-14 px-4 rounded-xl text-sm font-bold outline-none' },
                    options.map(o => h('option', { key: o.val, value: o.val }, o.label))));

            // --- RENDER ---
            return h('div', { className: 'min-h-screen bg-[#F5F5F5] text-slate-900 font-sans pb-32 md:pb-0' },
                h('header', { className: 'px-5 py-4 flex justify-between items-center bg-white border-b border-slate-200 sticky top-0 z-50 print-hidden shadow-sm italic-hub uppercase tracking-tighter leading-none' },
                    h('div', { className: 'flex items-center gap-4' },
                        h('button', { onClick: () => setIsMenuOpen(true), className: 'w-12 h-12 flex items-center justify-center bg-slate-50 rounded-xl hover:bg-slate-100 transition border border-slate-200 active:bg-slate-200' }, h('i', { className: 'fa-solid fa-bars text-xl' })),
                        h('div', { className: 'flex items-center gap-3 cursor-pointer', onClick: () => { setView('home'); setActiveFilter({parent:null}); } },
                            h('div', { className: 'w-12 h-12 bg-black rounded-xl flex items-center justify-center text-white shadow-lg' }, h('i', { className: 'fa-solid fa-box-archive text-xl' })),
                            h('span', { className: 'font-black text-2xl uppercase italic leading-none hidden md:block' }, 'NAZİLLİ', h('span', { className: 'text-slate-300' }, 'Dolap Fiyatlandırma'))
                        )
                    ),
                    h('div', { className: 'flex gap-3 items-center' },
                        h('button', { onClick: () => setView('cart'), className: 'relative w-12 h-12 bg-black text-white rounded-xl shadow-lg transition active:scale-95 flex items-center justify-center' },
                            h('i', { className: 'fa-solid fa-cart-shopping text-xl' }),
                            cart.length > 0 && h('span', { className: 'absolute -top-1 -right-1 bg-red-600 text-xs font-black w-6 h-6 rounded-full flex items-center justify-center border-2 border-white' }, cart.length)
                        )
                    )
                ),
                h(Fragment, null,
                    h('div', { className: `fixed inset-0 bg-black/60 backdrop-blur-sm z-[60] transition-opacity duration-300 print:hidden ${isMenuOpen ? 'opacity-100' : 'opacity-0 pointer-events-none'}`, onClick: () => setIsMenuOpen(false) }),
                    h('aside', { className: `fixed top-0 left-0 h-full w-[85%] max-w-[320px] bg-white z-[70] shadow-2xl transition-transform duration-300 ${isMenuOpen ? 'translate-x-0' : '-translate-x-full'}` },
                        h('div', { className: 'p-6 border-b flex justify-between items-center bg-slate-50 italic-hub uppercase tracking-tighter leading-none' },
                            h('span', { className: 'font-black text-2xl uppercase italic' }, 'Katalog'),
                            h('button', { onClick: () => setIsMenuOpen(false), className: 'p-4 bg-white rounded-xl shadow-sm border border-slate-100' }, h('i', { className: 'fa-solid fa-xmark text-xl' }))
                        ),
                        h('div', { className: 'p-5 space-y-4 overflow-y-auto h-full pb-20' },
                            h('button', { onClick: () => { setActiveFilter({parent:null}); setView('home'); setIsMenuOpen(false); }, className: `w-full text-left font-black text-base p-6 rounded-2xl uppercase tracking-[0.1em] transition ${!activeFilter.parent ? 'bg-black text-white shadow-xl' : 'bg-slate-50 text-slate-500 border border-slate-100'}` }, 'Tüm Ürünler'),
                            ['Alt Dolaplar', 'Üst Dolaplar', 'Duvar Dolapları'].map(cat => 
                                h('button', { key: cat, onClick: () => { setActiveFilter({parent:cat}); setView('home'); setIsMenuOpen(false); }, className: `w-full text-left font-black text-base p-6 rounded-2xl uppercase tracking-[0.1em] transition ${activeFilter.parent === cat ? 'bg-black text-white shadow-xl' : 'bg-slate-50 text-slate-500 border border-slate-100'}` }, cat)
                            )
                        )
                    )
                ),
                h('main', { className: 'py-6 px-4 md:px-8 print-hidden animate-fade' },
                    view === 'home' && h('div', { className: 'max-w-7xl mx-auto italic-hub uppercase tracking-tighter' },
                        h('h2', { className: 'text-2xl font-black mb-6 tracking-tight flex items-center gap-3 px-1 text-slate-900 leading-none uppercase' }, h('i', { className: 'fa-solid fa-layer-group text-slate-400' }), activeFilter.parent || 'Tüm Modüller'),
                        h('div', { className: 'grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 xl:grid-cols-5 gap-4' },
                            APP_DATA.PRODUCTS.filter(p => !activeFilter.parent || p.parentCat === activeFilter.parent).map(p => 
                                h('div', { key: p.id, className: 'bg-white p-4 rounded-[24px] border border-slate-200 shadow-sm active:scale-[0.98] transition-all cursor-pointer', onClick: () => setSelectedProduct(p) },
                                    h('div', { className: 'aspect-video sm:aspect-square rounded-2xl overflow-hidden bg-slate-100 mb-4 shadow-inner relative' },
                                        h('img', { src: p.image, className: 'w-full h-full object-cover', loading: 'lazy' }),
                                        h('div', { className: 'absolute bottom-2 right-2 bg-black/70 text-white px-3 py-1 rounded-lg text-xs font-bold backdrop-blur-sm' }, 'HIZLI EKLE')
                                    ),
                                    h('h4', { className: 'font-black text-lg leading-tight mb-4 text-slate-800 uppercase italic px-1' }, p.name),
                                    h('button', { onClick: (e) => { e.stopPropagation(); addToCart(p); }, className: 'w-full h-12 bg-slate-100 border border-slate-200 text-black text-sm font-black rounded-xl hover:bg-black hover:text-white transition uppercase italic leading-none flex items-center justify-center gap-2' }, h('i', { className: 'fa-solid fa-plus' }), 'SEPETE EKLE')
                                )
                            )
                        ),
                        selectedProduct && h('div', { className: 'fixed inset-0 z-[100] bg-black/90 flex items-center justify-center p-4 backdrop-blur-md', onClick: () => setSelectedProduct(null) },
                            h('div', { className: 'bg-white w-full max-w-md rounded-[32px] overflow-hidden shadow-2xl relative animate-fade', onClick: e => e.stopPropagation() },
                                h('div', { className: 'relative' },
                                    h('img', { src: selectedProduct.image, className: 'w-full aspect-video object-cover' }),
                                    h('button', { onClick: () => setSelectedProduct(null), className: 'absolute top-4 right-4 bg-white p-3 rounded-full w-12 h-12 flex items-center justify-center shadow-xl z-10' }, h('i', { className: 'fa-solid fa-xmark text-2xl' }))
                                ),
                                h('div', { className: 'p-8' },
                                    h('h3', { className: 'text-3xl font-black mb-8 tracking-tighter italic-hub uppercase leading-none' }, selectedProduct.name),
                                    h('button', { onClick: () => { addToCart(selectedProduct); setSelectedProduct(null); }, className: 'w-full h-16 bg-black text-white font-black rounded-2xl text-lg uppercase tracking-widest shadow-xl active:scale-95 transition italic-hub leading-none' }, 'SEPETE EKLE')
                                )
                            )
                        )
                    ),
                    view === 'cart' && h('div', { className: 'max-w-5xl mx-auto italic-hub uppercase tracking-tighter leading-none' },
                        h('div', { className: 'flex flex-col gap-6' },
                            h('div', { className: 'flex justify-between items-center px-1' },
                                h('h2', { className: 'text-2xl font-black tracking-tight text-slate-800 flex items-center gap-2' }, 'Sepet ', h('span', { className: 'text-slate-400 font-normal italic text-xl' }, `(${cart.length})`)),
                                h('button', { onClick: () => setView('home'), className: 'h-12 px-6 bg-white border border-slate-200 rounded-xl flex items-center gap-2 text-sm font-black uppercase hover:bg-slate-50 transition shadow-sm active:scale-95' }, h('i', { className: 'fa-solid fa-plus' }), ' Ürün Ekle')
                            ),
                            cart.length > 0 ? h(Fragment, null,
                                h('div', { className: 'bg-white p-6 rounded-[32px] border border-slate-200 shadow-sm flex flex-col gap-4' },
                                    h('div', { className: 'flex items-center gap-2 text-slate-400 font-bold text-sm mb-2' }, h('i', { className: 'fa-solid fa-wand-magic-sparkles' }), ' TOPLU DÜZENLEME'),
                                    h('div', { className: 'grid grid-cols-1 md:grid-cols-3 gap-4' },
                                        h('div', null, h('label', { className: 'text-xs font-bold text-slate-400 mb-2 block ml-1' }, 'Gövde'), h('select', { value: bulkConfig.bodyMaterial, onChange: e => setBulkConfig({...bulkConfig, bodyMaterial: e.target.value}), className: 'w-full bg-slate-50 border border-slate-200 rounded-xl h-14 px-4 text-sm font-bold outline-none' }, Object.keys(settings.materialPrices).map(m => h('option', { key: m, value: m }, m)))),
                                        h('div', null, h('label', { className: 'text-xs font-bold text-slate-400 mb-2 block ml-1' }, 'Kapak'), h('select', { value: bulkConfig.doorMaterial, onChange: e => setBulkConfig({...bulkConfig, doorMaterial: e.target.value}), className: 'w-full bg-slate-50 border border-slate-200 rounded-xl h-14 px-4 text-sm font-bold outline-none' }, Object.keys(settings.materialPrices).map(m => h('option', { key: m, value: m }, m)))),
                                        h('div', null, h('label', { className: 'text-xs font-bold text-slate-400 mb-2 block ml-1' }, 'Marka'), h('select', { value: bulkConfig.hardwareBrand, onChange: e => setBulkConfig({...bulkConfig, hardwareBrand: e.target.value}), className: 'w-full bg-slate-50 border border-slate-200 rounded-xl h-14 px-4 text-sm font-bold outline-none' }, ['Samet', 'Blum', 'Hettich'].map(m => h('option', { key: m, value: m }, m))))
                                    ),
                                    h('button', { onClick: applyBulkToAll, className: 'w-full h-14 bg-black text-white text-base font-black rounded-xl hover:scale-[1.02] active:scale-95 transition shadow-lg mt-2' }, 'TÜMÜNE UYGULA')
                                ),
                                cart.map(item => h('div', { key: item.id, className: 'bg-white p-5 rounded-[32px] border border-slate-200 shadow-sm flex flex-col gap-6 relative overflow-hidden' },
                                    h('div', { className: 'flex gap-4 items-start border-b border-slate-100 pb-5' },
                                        h('div', { className: 'w-24 h-24 rounded-2xl overflow-hidden shrink-0 bg-slate-100 border border-slate-200' }, h('img', { src: item.product.image, className: 'w-full h-full object-cover', loading: 'lazy' })),
                                        h('div', { className: 'flex-grow min-w-0 pt-1' },
                                            h('h4', { className: 'font-black text-lg leading-tight mb-2 uppercase italic truncate' }, item.product.name),
                                            h('div', { className: 'text-2xl font-black text-slate-900 mb-2' }, (calculateItemPrice(item, settings) * (item.qty || 1)).toLocaleString('tr-TR'), h('span', { className: 'text-sm text-slate-400 font-medium' }, ' TL')),
                                            h('div', { className: 'flex items-center gap-3 mt-2' },
                                                h('div', { className: 'flex items-center bg-slate-50 rounded-xl border border-slate-200 h-12' },
                                                    h('button', { onClick: () => updateItemQty(item.id, -1), className: 'w-12 h-full text-xl font-bold text-slate-500 active:bg-slate-200 rounded-l-xl' }, '-'),
                                                    h('span', { className: 'w-8 text-center font-black text-lg' }, item.qty || 1),
                                                    h('button', { onClick: () => updateItemQty(item.id, 1), className: 'w-12 h-full text-xl font-bold text-slate-500 active:bg-slate-200 rounded-r-xl' }, '+')
                                                ),
                                                h('button', { onClick: () => duplicateItem(item), className: 'w-12 h-12 flex items-center justify-center bg-blue-50 text-blue-600 rounded-xl' }, h('i', { className: 'fa-solid fa-copy text-lg' })),
                                                h('button', { onClick: () => setCart(cart.filter(c => c.id !== item.id)), className: 'w-12 h-12 flex items-center justify-center bg-red-50 text-red-600 rounded-xl' }, h('i', { className: 'fa-solid fa-trash-can text-lg' }))
                                            )
                                        )
                                    ),
                                    h('div', { className: 'grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4' },
                                        item.product.type === 'wall_cabinet' ? h(Fragment, null,
                                            renderSelect('Dolap Şekli', item.config.cabinetShape, 'cabinetShape', item.id, [{val:'Düz',label:'Düz'},{val:'L',label:'L Köşe'},{val:'U',label:'U Tipi'}]),
                                            renderInput('Genişlik (cm)', item.config.width, 'width', item.id, 'number'),
                                            ['L', 'U'].includes(item.config.cabinetShape) && renderInput('Genişlik 2 (cm)', item.config.width2, 'width2', item.id, 'number'),
                                            item.config.cabinetShape === 'U' && renderInput('Genişlik 3 (cm)', item.config.width3, 'width3', item.id, 'number'),
                                            renderInput('Yükseklik (cm)', item.config.height, 'height', item.id, 'number'),
                                            renderInput('Derinlik (cm)', item.config.depth, 'depth', item.id, 'number'),
                                            h('div', { className: 'md:col-span-2' }, renderSelect('Kapak Tipi', item.config.doorType, 'doorType', item.id, [{val:'hinged',label:'Menteşe Kapak'},{val:'sliding',label:'Sürme (Raylı) Kapak'}])),
                                            item.config.doorType === 'sliding' 
                                                ? h('div', { className: 'md:col-span-2' }, renderInput('Sürme Kapak Sayısı', item.config.slidingDoorCount, 'slidingDoorCount', item.id, 'number', 'Adet'))
                                                : h(Fragment, null, renderInput('Dolu Kapak', item.config.solidDoorCount, 'solidDoorCount', item.id, 'number'), renderInput('Camlı Kapak', item.config.glassDoorCount, 'glassDoorCount', item.id, 'number')),
                                            renderInput('Çekmece', item.config.drawerCount, 'drawerCount', item.id, 'number'),
                                            renderSelect('Donanım', item.config.hardwareBrand, 'hardwareBrand', item.id, ['Samet', 'Blum', 'Hettich'].map(b => ({val: b, label: b})))
                                        ) : h(Fragment, null,
                                            renderInput('Genişlik (cm)', item.config.width, 'width', item.id, 'number'),
                                            ['corner_base', 'corner_upper'].includes(item.product.type) && renderInput('Genişlik 2 (cm)', item.config.width2, 'width2', item.id, 'number'),
                                            renderInput('Yükseklik (cm)', item.config.height, 'height', item.id, 'number'),
                                            renderInput('Derinlik (cm)', item.config.depth, 'depth', item.id, 'number'),
                                            (item.product.type === 'drawer' || (item.product.type === 'wall_cabinet' && item.config.drawerCount > 0)) && h(Fragment, null, renderInput('Çekmece', item.config.drawerCount, 'drawerCount', item.id, 'number'), h('div', { className: 'md:col-span-2' }, renderSelect('Ray Marka', item.config.hardwareBrand, 'hardwareBrand', item.id, ['Samet', 'Blum', 'Hettich'].map(b => ({val: b, label: b}))))),
                                            ['hinged_base', 'hinged_upper', 'corner_base', 'corner_upper', 'blind_corner_base', 'blind_upper'].includes(item.product.type) && h(Fragment, null, item.config.doorType !== 'lift' && renderInput('Kapak Adet', item.config.doorCount, 'doorCount', item.id, 'number'), renderInput('Raf Adet', item.config.shelfCount, 'shelfCount', item.id, 'number'), item.product.type !== 'lift_upper' && h('div', { className: 'md:col-span-2' }, renderSelect('Menteşe Marka', item.config.hardwareBrand, 'hardwareBrand', item.id, Object.keys(settings.hardwarePrices.hinges).map(b => ({val: b, label: b}))))),
                                            item.product.type === 'lift_upper' && h('div', { className: 'md:col-span-2' }, renderSelect('Piston Marka', item.config.hardwareBrand, 'hardwareBrand', item.id, Object.keys(settings.hardwarePrices.liftSystemBrands).map(b => ({val: b, label: b})))),
                                            item.product.parentCat === 'Üst Dolaplar' && h('div', { className: 'md:col-span-2' }, renderSelect('Kapak Stili', item.config.doorStyle, 'doorStyle', item.id, [{val:'normal',label:'Normal'},{val:'glass',label:'Camlı'}]))
                                        ),
                                        h('div', { className: 'col-span-1 md:col-span-2 lg:col-span-4 mt-2' },
                                            h('label', { className: 'text-xs font-bold text-slate-400 mb-2 block ml-1 uppercase' }, 'Malzeme Seçimi (Gövde / Kapak)'),
                                            h('div', { className: 'flex flex-col md:flex-row gap-3' },
                                                h('select', { value: item.config.bodyMaterial, onChange: e => updateItemConfig(item.id, 'bodyMaterial', e.target.value), className: 'w-full bg-slate-50 border border-slate-200 h-14 px-4 rounded-xl text-sm font-bold outline-none uppercase italic' }, Object.keys(settings.materialPrices).map(m => h('option', { key: m, value: m }, `${m.slice(0,3)} (G)`))),
                                                h('select', { value: item.config.doorMaterial, onChange: e => updateItemConfig(item.id, 'doorMaterial', e.target.value), className: 'w-full bg-slate-50 border border-slate-200 h-14 px-4 rounded-xl text-sm font-bold outline-none uppercase italic' }, Object.keys(settings.materialPrices).map(m => h('option', { key: m, value: m }, `${m.slice(0,3)} (K)`)))
                                            )
                                        )
                                    )
                                ))
                            ) : h('div', { className: 'text-center py-20 px-6 bg-white rounded-[32px] border-2 border-dashed border-slate-200' },
                                h('div', { className: 'w-20 h-20 bg-slate-50 rounded-full flex items-center justify-center mx-auto mb-4' }, h('i', { className: 'fa-solid fa-basket-shopping text-3xl text-slate-300' })),
                                h('h3', { className: 'text-xl font-black text-slate-900 mb-2' }, 'Sepetiniz Boş'),
                                h('p', { className: 'text-slate-400 font-medium mb-6' }, 'Projenize başlamak için ürün kataloğundan modül ekleyin.'),
                                h('button', { onClick: () => setView('home'), className: 'px-8 py-4 bg-black text-white rounded-2xl font-bold uppercase tracking-widest shadow-lg' }, 'Kataloğa Git')
                            )
                        ),
                        cart.length > 0 && h('div', { className: 'mt-8 space-y-6' },
                            h('div', { className: 'bg-white p-6 rounded-[32px] border border-slate-200 shadow-sm' },
                                h('h3', { className: 'text-xs font-black uppercase tracking-[0.2em] text-slate-400 mb-4 flex items-center gap-2' }, h('i', { className: 'fa-solid fa-address-card' }), ' Müşteri Bilgileri'),
                                h('div', { className: 'grid grid-cols-1 md:grid-cols-2 gap-4' },
                                    h('input', { type: 'text', placeholder: 'Ad Soyad', value: customer.name, onChange: e => setCustomer({...customer, name: e.target.value}), className: 'w-full bg-slate-50 border border-slate-100 p-4 rounded-xl text-base font-bold outline-none focus:border-black h-14' }),
                                    h('input', { type: 'tel', placeholder: 'Telefon No', value: customer.phone, onChange: e => setCustomer({...customer, phone: e.target.value}), className: 'w-full bg-slate-50 border border-slate-100 p-4 rounded-xl text-base font-bold outline-none focus:border-black h-14' })
                                )
                            ),
                            h('div', { className: 'bg-black text-white p-8 rounded-[40px] shadow-xl text-center' },
                                h('p', { className: 'text-sm font-bold text-slate-400 uppercase mb-2' }, 'Genel Toplam'),
                                h('h3', { className: 'text-5xl md:text-7xl font-black mb-8 italic tracking-tighter' }, cartTotal.toLocaleString('tr-TR'), h('span', { className: 'text-2xl text-slate-500 font-normal ml-2' }, 'TL')),
                                h('button', { onClick: () => setShowTeklifPreview(true), className: 'w-full h-16 bg-white text-black rounded-2xl font-black text-lg uppercase tracking-widest hover:scale-[1.02] active:scale-95 transition' }, 'TEKLİF DOSYASI OLUŞTUR')
                            )
                        )
                    ),
                    view === 'admin' && h('div', { className: 'max-w-xl mx-auto py-4' },
                        h('div', { className: 'bg-white p-6 rounded-[32px] border border-slate-200 shadow-sm space-y-6' },
                            h('h2', { className: 'text-2xl font-black tracking-tighter italic uppercase border-b pb-4' }, 'Admin Ayarları'),
                            Object.keys(settings.materialPrices).map(m => 
                                h('div', { key: m, className: 'flex justify-between items-center bg-slate-50 p-4 rounded-xl border border-slate-100' },
                                    h('span', { className: 'text-sm font-bold text-slate-700 uppercase' }, m),
                                    h('div', { className: 'flex items-center gap-2' },
                                        h('input', { type: 'number', value: settings.materialPrices[m], onChange: e => setSettings({...settings, materialPrices: {...settings.materialPrices, [m]: Number(e.target.value)}}), className: 'w-24 bg-white border border-slate-200 h-12 rounded-lg text-right font-black px-3 outline-none' }),
                                        h('span', { className: 'text-xs font-bold text-slate-400' }, 'TL')
                                    )
                                )
                            )
                        )
                    ),
                    showTeklifPreview && h('div', { className: 'fixed inset-0 z-[200] bg-white flex flex-col print:block', id: 'pdf-content' },
                        h('div', { className: 'p-4 border-b flex justify-between items-center bg-slate-50 shrink-0 print:hidden' },
                            h('h3', { className: 'font-black text-lg uppercase' }, 'Önizleme'),
                            h('div', { className: 'flex gap-2' },
                                h('button', { onClick: () => setShowTeklifPreview(false), className: 'px-4 py-2 bg-white border rounded-xl font-bold text-sm' }, 'Kapat'),
                                h('button', { onClick: () => window.print(), className: 'px-4 py-2 bg-black text-white rounded-xl font-bold text-sm' }, 'Yazdır')
                            )
                        ),
                        h('div', { className: 'flex-grow overflow-y-auto p-4 md:p-12' },
                            h('div', { className: 'w-full max-w-[800px] mx-auto uppercase tracking-tighter leading-none italic uppercase' },
                                h('div', { className: 'flex justify-between items-start border-b-4 border-black pb-8 mb-10 italic-hub uppercase' },
                                    h('div', null, h('h1', { className: 'text-3xl md:text-4xl font-black mb-1 italic uppercase leading-none' }, 'TEKLİF FORMU'), h('p', { className: 'text-xs font-bold text-slate-400 font-mono italic' }, `#${Date.now().toString().slice(-6)} | ${new Date().toLocaleDateString('tr-TR')}`)),
                                    h('div', { className: 'text-right italic uppercase leading-none' }, h('h2', { className: 'font-black text-2xl uppercase italic leading-none italic uppercase' }, 'NAZİLLİ', h('span', { className: 'text-slate-300 italic' }, 'Dolap Fiyatlandırma')), h('p', { className: 'text-[10px] font-black text-slate-400 mt-1 uppercase tracking-widest italic tracking-tighter leading-none uppercase italic' }, 'Mobilya Üretim Atölyesi'))
                                ),
                                h('table', { className: 'w-full text-left border-collapse italic uppercase tracking-tighter leading-none italic uppercase' },
                                    h('thead', null, h('tr', { className: 'border-b-2 border-black font-black uppercase text-[10px] tracking-widest leading-none' },
                                        h('th', { className: 'py-4 italic uppercase' }, 'Görsel'),
                                        h('th', { className: 'py-4 italic uppercase' }, 'Modül'),
                                        h('th', { className: 'py-4 text-center italic uppercase' }, 'Boyutlar'),
                                        h('th', { className: 'py-4 italic uppercase' }, 'Detaylar & Donanım'),
                                        h('th', { className: 'py-4 text-right italic uppercase' }, 'Tutar')
                                    )),
                                    h('tbody', null, cart.map(item => 
                                        h('tr', { key: item.id, className: 'border-b border-slate-100 italic tracking-tighter leading-none uppercase' },
                                            h('td', { className: 'py-5 w-16 align-middle' }, h('img', { src: item.product.image, className: 'w-12 h-12 object-cover rounded-lg border border-slate-200' })),
                                            h('td', { className: 'py-5 font-bold text-sm text-slate-800 uppercase italic leading-none' }, item.product.name, item.qty > 1 && h('span', { className: 'text-xs text-slate-400 block mt-1' }, `(x ${item.qty} Adet)`)),
                                            h('td', { className: 'py-5 text-xs font-bold text-slate-500 text-center italic leading-none uppercase' }, ['corner_base', 'corner_upper', 'wall_cabinet'].includes(item.product.type) && item.config.cabinetShape !== 'Düz' ? `${item.config.width}+${item.config.width2}` : item.config.width, 'x', item.config.height),
                                            h('td', { className: 'py-5 text-[10px] leading-tight uppercase italic leading-none' },
                                                h('span', { className: 'font-bold text-slate-400 text-[9px] uppercase italic leading-none' }, 'Gövde: '), h('span', { className: 'font-black text-slate-700 italic uppercase leading-none' }, item.config.bodyMaterial), h('br'),
                                                h('span', { className: 'font-bold text-slate-400 text-[9px] uppercase italic leading-none' }, 'Kapak: '), h('span', { className: 'font-black text-slate-700 italic uppercase leading-none' }, item.config.doorStyle === 'glass' ? 'CAMLI' : item.config.doorMaterial), h('br'),
                                                h('span', { className: 'text-amber-600 font-bold text-[9px] mt-1 block uppercase italic leading-none uppercase' },
                                                    item.config.doorType === 'lift' ? `Piston: ${item.config.hardwareBrand}` : (item.product.type === 'drawer' || item.config.drawerCount > 0) ? `${item.config.hardwareBrand} Ray` : `${item.config.hardwareBrand} Mnt`,
                                                    item.config.shelfCount > 0 && ` | Raf: ${item.config.shelfCount}`,
                                                    item.config.drawerCount > 0 && ` | Çekm: ${item.config.drawerCount}`,
                                                    item.product.type === 'wall_cabinet' && item.config.doorType === 'sliding' && ` | ${item.config.slidingDoorCount} Sürme Kapak`,
                                                    item.product.type === 'wall_cabinet' && item.config.doorType === 'hinged' && ` | ${item.config.solidDoorCount} Dolu + ${item.config.glassDoorCount} Camlı`
                                                )
                                            ),
                                            h('td', { className: 'py-5 text-right font-black text-sm italic uppercase leading-none' }, (calculateItemPrice(item, settings) * (item.qty || 1)).toLocaleString('tr-TR'), ' TL')
                                        )
                                    ))
                                ),
                                h('div', { className: 'text-right mt-12 border-t-4 border-black pt-8' },
                                    h('p', { className: 'text-[10px] font-black text-slate-300 uppercase mb-2 italic uppercase' }, 'Genel Toplam'),
                                    h('h2', { className: 'text-5xl font-black uppercase italic leading-none' }, cartTotal.toLocaleString('tr-TR'), ' TL')
                                )
                            )
                        )
                    )
                );
            };

            const root = ReactDOM.createRoot(document.getElementById('root'));
            root.render(h(App));
        
    </script>
</body>
</html>
